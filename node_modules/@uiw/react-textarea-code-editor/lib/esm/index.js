import _extends from "@babel/runtime/helpers/extends";
import _objectSpread from "@babel/runtime/helpers/objectSpread2";
import _slicedToArray from "@babel/runtime/helpers/slicedToArray";
import _objectWithoutProperties from "@babel/runtime/helpers/objectWithoutProperties";
var _excluded = ["prefixCls", "value", "padding", "minHeight", "placeholder", "language", "className", "style", "onChange"];
import React, { useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';
import { processHtml, htmlEncode } from './utils';
import shortcuts from './shortcuts';
import * as styles from './styles';
import "./style/index.css";
export * from './SelectionText';
export default /*#__PURE__*/React.forwardRef(function (props, ref) {
  var _props$prefixCls = props.prefixCls,
      prefixCls = _props$prefixCls === void 0 ? 'w-tc-editor' : _props$prefixCls,
      _ = props.value,
      _props$padding = props.padding,
      padding = _props$padding === void 0 ? 10 : _props$padding,
      _props$minHeight = props.minHeight,
      minHeight = _props$minHeight === void 0 ? 16 : _props$minHeight,
      placeholder = props.placeholder,
      language = props.language,
      className = props.className,
      style = props.style,
      _onChange = props.onChange,
      other = _objectWithoutProperties(props, _excluded);

  var _useState = useState(props.value || ''),
      _useState2 = _slicedToArray(_useState, 2),
      value = _useState2[0],
      setValue = _useState2[1];

  useEffect(function () {
    return setValue(props.value || '');
  }, [props.value]);
  var textRef = useRef(null);
  useImperativeHandle(ref, function () {
    return textRef.current;
  });
  var contentStyle = {
    paddingTop: padding,
    paddingRight: padding,
    paddingBottom: padding,
    paddingLeft: padding
  };
  var htmlStr = useMemo(function () {
    return processHtml("<pre aria-hidden=true><code ".concat(language ? "class=\"language-".concat(language, "\"") : '', " >").concat(htmlEncode(String(value || '')), "</code><br /></pre>"));
  }, [value, language]);
  var preView = useMemo(function () {
    return /*#__PURE__*/React.createElement("div", {
      style: _objectSpread(_objectSpread(_objectSpread({}, styles.editor), contentStyle), {}, {
        minHeight: minHeight
      }),
      className: "".concat(prefixCls, "-preview ").concat(language ? "language-".concat(language) : ''),
      dangerouslySetInnerHTML: {
        __html: htmlStr
      }
    });
  }, // eslint-disable-next-line react-hooks/exhaustive-deps
  [prefixCls, language, htmlStr]);
  return /*#__PURE__*/React.createElement("div", {
    style: _objectSpread(_objectSpread({}, styles.container), style),
    className: "".concat(prefixCls, " ").concat(className || '')
  }, /*#__PURE__*/React.createElement("textarea", _extends({
    autoComplete: "off",
    autoCorrect: "off",
    spellCheck: "false",
    autoCapitalize: "off"
  }, other, {
    placeholder: placeholder,
    onKeyDown: function onKeyDown(evn) {
      shortcuts(evn);
      other.onKeyDown && other.onKeyDown(evn);
    },
    style: _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, styles.editor), styles.textarea), contentStyle), {}, {
      minHeight: minHeight
    }, placeholder && !value ? {
      WebkitTextFillColor: 'inherit'
    } : {}),
    ref: textRef,
    onChange: function onChange(evn) {
      setValue(evn.target.value);
      _onChange && _onChange(evn);
    },
    className: "".concat(prefixCls, "-text"),
    value: value
  })), preView);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9pbmRleC50c3giXSwibmFtZXMiOlsiUmVhY3QiLCJ1c2VFZmZlY3QiLCJ1c2VJbXBlcmF0aXZlSGFuZGxlIiwidXNlTWVtbyIsInVzZVJlZiIsInVzZVN0YXRlIiwicHJvY2Vzc0h0bWwiLCJodG1sRW5jb2RlIiwic2hvcnRjdXRzIiwic3R5bGVzIiwiZm9yd2FyZFJlZiIsInByb3BzIiwicmVmIiwicHJlZml4Q2xzIiwiXyIsInZhbHVlIiwicGFkZGluZyIsIm1pbkhlaWdodCIsInBsYWNlaG9sZGVyIiwibGFuZ3VhZ2UiLCJjbGFzc05hbWUiLCJzdHlsZSIsIm9uQ2hhbmdlIiwib3RoZXIiLCJzZXRWYWx1ZSIsInRleHRSZWYiLCJjdXJyZW50IiwiY29udGVudFN0eWxlIiwicGFkZGluZ1RvcCIsInBhZGRpbmdSaWdodCIsInBhZGRpbmdCb3R0b20iLCJwYWRkaW5nTGVmdCIsImh0bWxTdHIiLCJTdHJpbmciLCJwcmVWaWV3IiwiZWRpdG9yIiwiX19odG1sIiwiY29udGFpbmVyIiwiZXZuIiwib25LZXlEb3duIiwidGV4dGFyZWEiLCJXZWJraXRUZXh0RmlsbENvbG9yIiwidGFyZ2V0Il0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU9BLEtBQVAsSUFBZ0JDLFNBQWhCLEVBQTJCQyxtQkFBM0IsRUFBZ0RDLE9BQWhELEVBQXlEQyxNQUF6RCxFQUFpRUMsUUFBakUsUUFBaUYsT0FBakY7QUFDQSxTQUFTQyxXQUFULEVBQXNCQyxVQUF0QixRQUF3QyxTQUF4QztBQUNBLE9BQU9DLFNBQVAsTUFBc0IsYUFBdEI7QUFDQSxPQUFPLEtBQUtDLE1BQVosTUFBd0IsVUFBeEI7QUFDQTtBQUVBLGNBQWMsaUJBQWQ7QUFrQkEsNEJBQWVULEtBQUssQ0FBQ1UsVUFBTixDQUErRCxVQUFDQyxLQUFELEVBQVFDLEdBQVIsRUFBZ0I7QUFDNUYseUJBV0lELEtBWEosQ0FDRUUsU0FERjtBQUFBLE1BQ0VBLFNBREYsaUNBQ2MsYUFEZDtBQUFBLE1BRVND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Q0FBbkI7QUFDRCxLQVZIO0FBV0UsSUFBQSxLQUFLLDhEQUNBN0IsTUFBTSxDQUFDMEIsTUFEUCxHQUVBMUIsTUFBTSxDQUFDK0IsUUFGUCxHQUdBYixZQUhBO0FBSUhWLE1BQUFBLFNBQVMsRUFBVEE7QUFKRyxPQUtDQyxXQUFXLElBQUksQ0FBQ0gsS0FBaEIsR0FBd0I7QUFBRTBCLE1BQUFBLG1CQUFtQixFQUFFO0FBQXZCLEtBQXhCLEdBQTZELEVBTDlELENBWFA7QUFrQkUsSUFBQSxHQUFHLEVBQUVoQixPQWxCUDtBQW1CRSxJQUFBLFFBQVEsRUFBRSxrQkFBQ2EsR0FBRCxFQUFTO0FBQ2pCZCxNQUFBQSxRQUFRLENBQUNjLEdBQUcsQ0FBQ0ksTUFBSixDQUFXM0IsS0FBWixDQUFSO0FBQ0FPLE1BQUFBLFNBQVEsSUFBSUEsU0FBUSxDQUFDZ0IsR0FBRCxDQUFwQjtBQUNELEtBdEJIO0FBdUJFLElBQUEsU0FBUyxZQUFLekIsU0FBTCxVQXZCWDtBQXdCRSxJQUFBLEtBQUssRUFBRUU7QUF4QlQsS0FERixFQTJCR21CLE9BM0JILENBREY7QUErQkQsQ0FoRmMsQ0FBZiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VFZmZlY3QsIHVzZUltcGVyYXRpdmVIYW5kbGUsIHVzZU1lbW8sIHVzZVJlZiwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBwcm9jZXNzSHRtbCwgaHRtbEVuY29kZSB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHNob3J0Y3V0cyBmcm9tICcuL3Nob3J0Y3V0cyc7XG5pbXBvcnQgKiBhcyBzdHlsZXMgZnJvbSAnLi9zdHlsZXMnO1xuaW1wb3J0ICcuL3N0eWxlL2luZGV4Lmxlc3MnO1xuXG5leHBvcnQgKiBmcm9tICcuL1NlbGVjdGlvblRleHQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRleHRhcmVhQ29kZUVkaXRvclByb3BzIGV4dGVuZHMgUmVhY3QuVGV4dGFyZWFIVE1MQXR0cmlidXRlczxIVE1MVGV4dEFyZWFFbGVtZW50PiB7XG4gIHByZWZpeENscz86IHN0cmluZztcbiAgLyoqXG4gICAqIFNldCB3aGF0IHByb2dyYW1taW5nIGxhbmd1YWdlIHRoZSBjb2RlIGJlbG9uZ3MgdG8uXG4gICAqL1xuICBsYW5ndWFnZT86IHN0cmluZztcbiAgLyoqXG4gICAqIE9wdGlvbmFsIHBhZGRpbmcgZm9yIGNvZGUuIERlZmF1bHQ6IGAxMGAuXG4gICAqL1xuICBwYWRkaW5nPzogbnVtYmVyO1xuICAvKipcbiAgICogVGhlIG1pbmltdW0gaGVpZ2h0IG9mIHRoZSBlZGl0b3IuIERlZmF1bHQ6IGAxNmAuXG4gICAqL1xuICBtaW5IZWlnaHQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBkZWZhdWx0IFJlYWN0LmZvcndhcmRSZWY8SFRNTFRleHRBcmVhRWxlbWVudCwgVGV4dGFyZWFDb2RlRWRpdG9yUHJvcHM+KChwcm9wcywgcmVmKSA9PiB7XG4gIGNvbnN0IHtcbiAgICBwcmVmaXhDbHMgPSAndy10Yy1lZGl0b3InLFxuICAgIHZhbHVlOiBfLFxuICAgIHBhZGRpbmcgPSAxMCxcbiAgICBtaW5IZWlnaHQgPSAxNixcbiAgICBwbGFjZWhvbGRlcixcbiAgICBsYW5ndWFnZSxcbiAgICBjbGFzc05hbWUsXG4gICAgc3R5bGUsXG4gICAgb25DaGFuZ2UsXG4gICAgLi4ub3RoZXJcbiAgfSA9IHByb3BzO1xuXG4gIGNvbnN0IFt2YWx1ZSwgc2V0VmFsdWVdID0gdXNlU3RhdGUocHJvcHMudmFsdWUgfHwgJycpO1xuICB1c2VFZmZlY3QoKCkgPT4gc2V0VmFsdWUocHJvcHMudmFsdWUgfHwgJycpLCBbcHJvcHMudmFsdWVdKTtcbiAgY29uc3QgdGV4dFJlZiA9IHVzZVJlZjxIVE1MVGV4dEFyZWFFbGVtZW50PihudWxsKTtcbiAgdXNlSW1wZXJhdGl2ZUhhbmRsZTxIVE1MVGV4dEFyZWFFbGVtZW50LCBIVE1MVGV4dEFyZWFFbGVtZW50PihyZWYsICgpID0+IHRleHRSZWYuY3VycmVudCEpO1xuXG4gIGNvbnN0IGNvbnRlbnRTdHlsZSA9IHtcbiAgICBwYWRkaW5nVG9wOiBwYWRkaW5nLFxuICAgIHBhZGRpbmdSaWdodDogcGFkZGluZyxcbiAgICBwYWRkaW5nQm90dG9tOiBwYWRkaW5nLFxuICAgIHBhZGRpbmdMZWZ0OiBwYWRkaW5nLFxuICB9O1xuXG4gIGNvbnN0IGh0bWxTdHIgPSB1c2VNZW1vKFxuICAgICgpID0+XG4gICAgICBwcm9jZXNzSHRtbChcbiAgICAgICAgYDxwcmUgYXJpYS1oaWRkZW49dHJ1ZT48Y29kZSAke2xhbmd1YWdlID8gYGNsYXNzPVwibGFuZ3VhZ2UtJHtsYW5ndWFnZX1cImAgOiAnJ30gPiR7aHRtbEVuY29kZShcbiAgICAgICAgICBTdHJpbmcodmFsdWUgfHwgJycpLFxuICAgICAgICApfTwvY29kZT48YnIgLz48L3ByZT5gLFxuICAgICAgKSxcbiAgICBbdmFsdWUsIGxhbmd1YWdlXSxcbiAgKTtcbiAgY29uc3QgcHJlVmlldyA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKFxuICAgICAgPGRpdlxuICAgICAgICBzdHlsZT17eyAuLi5zdHlsZXMuZWRpdG9yLCAuLi5jb250ZW50U3R5bGUsIG1pbkhlaWdodCB9fVxuICAgICAgICBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30tcHJldmlldyAke2xhbmd1YWdlID8gYGxhbmd1YWdlLSR7bGFuZ3VhZ2V9YCA6ICcnfWB9XG4gICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7XG4gICAgICAgICAgX19odG1sOiBodG1sU3RyLFxuICAgICAgICB9fVxuICAgICAgLz5cbiAgICApLFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgICBbcHJlZml4Q2xzLCBsYW5ndWFnZSwgaHRtbFN0cl0sXG4gICk7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IHN0eWxlPXt7IC4uLnN0eWxlcy5jb250YWluZXIsIC4uLnN0eWxlIH19IGNsYXNzTmFtZT17YCR7cHJlZml4Q2xzfSAke2NsYXNzTmFtZSB8fCAnJ31gfT5cbiAgICAgIDx0ZXh0YXJlYVxuICAgICAgICBhdXRvQ29tcGxldGU9XCJvZmZcIlxuICAgICAgICBhdXRvQ29ycmVjdD1cIm9mZlwiXG4gICAgICAgIHNwZWxsQ2hlY2s9XCJmYWxzZVwiXG4gICAgICAgIGF1dG9DYXBpdGFsaXplPVwib2ZmXCJcbiAgICAgICAgey4uLm90aGVyfVxuICAgICAgICBwbGFjZWhvbGRlcj17cGxhY2Vob2xkZXJ9XG4gICAgICAgIG9uS2V5RG93bj17KGV2bikgPT4ge1xuICAgICAgICAgIHNob3J0Y3V0cyhldm4pO1xuICAgICAgICAgIG90aGVyLm9uS2V5RG93biAmJiBvdGhlci5vbktleURvd24oZXZuKTtcbiAgICAgICAgfX1cbiAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAuLi5zdHlsZXMuZWRpdG9yLFxuICAgICAgICAgIC4uLnN0eWxlcy50ZXh0YXJlYSxcbiAgICAgICAgICAuLi5jb250ZW50U3R5bGUsXG4gICAgICAgICAgbWluSGVpZ2h0LFxuICAgICAgICAgIC4uLihwbGFjZWhvbGRlciAmJiAhdmFsdWUgPyB7IFdlYmtpdFRleHRGaWxsQ29sb3I6ICdpbmhlcml0JyB9IDoge30pLFxuICAgICAgICB9fVxuICAgICAgICByZWY9e3RleHRSZWZ9XG4gICAgICAgIG9uQ2hhbmdlPXsoZXZuKSA9PiB7XG4gICAgICAgICAgc2V0VmFsdWUoZXZuLnRhcmdldC52YWx1ZSk7XG4gICAgICAgICAgb25DaGFuZ2UgJiYgb25DaGFuZ2UoZXZuKTtcbiAgICAgICAgfX1cbiAgICAgICAgY2xhc3NOYW1lPXtgJHtwcmVmaXhDbHN9LXRleHRgfVxuICAgICAgICB2YWx1ZT17dmFsdWV9XG4gICAgICAvPlxuICAgICAge3ByZVZpZXd9XG4gICAgPC9kaXY+XG4gICk7XG59KTtcbiJdfQ==